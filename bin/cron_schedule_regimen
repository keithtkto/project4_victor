#!/usr/bin/env node

var debug = require('debug')('task');

var CronJob = require('cron').CronJob;
// var Task    = require('../tasks/schedule_regimen');
var User = require("../models/user");

var args = process.argv.slice(2),
    pattern;

if (args[0] === 'test') {
  pattern = '*/5 * * * * *';
} else {
  pattern = '* */15 * * * *';
}

var cj = new CronJob(pattern, function() {
  debug("-> starting cron_schedule_regimenâ€¦");

  // Task.run().then(function() {
  //   debug("-> closing cron_schedule_regimen.");
  // }).catch(function(err) { debug(err) });
  User
    .find({}).exec()
    .then(function(users) {
      debug("Users>", users);
    })
    .catch(function(err) { debug("Err>", err) })
    .then(function() { debug("-> closing cron_schedule_regimen.") });

}, null, true, 'America/Los_Angeles');
